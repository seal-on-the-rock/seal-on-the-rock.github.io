---
layout: post
title: "article0004-LAMP"
date: 2025-10-23
author: Seal
---


# ☁️ article0005　LAMP

久しぶりです。

今日はよくあるフレームワーク　LAMP　の構成を紹介します。

先ずは、LAMPとは何ですか？

LAMP　＝　Linux　＋　Apache　＋　MySQL　＋　PHP　という現代よく使っているWEBシステムの構成フレームワークです。

Linux、MySQLとPHPは置いておいて、先ずはApacheを見てみましょう。

Apache ＝　Apache HTTP Serverです。あれ！server？そうですよね、先ずはApacheはHTTP関連Webシステムに向けてのサービスです。

一方で、AWS　＝　Amazon Web Servicesとのことです。AWSとApacheは同じにサービスとなっています。

しかも、昔Apacheを使って構築されたWebアプリケーションは今の時代でAWSの各サービスで組み立て構築することになります。

![ApacheからAWSへ]( /assets/images/0005-1.png )

Apacheが果たす役割については、以下の主要な七つの機能です。

⑴　静的コンテンツを配信（Static Content）

　　HTMLファイル、画像（.jpg、.png）、CSS、JavaScriptなどそのまま提供する
  
  　　　eg:seal-on-the-rockは僕のAWS技術ブログですが、homeのウェブページはindex.htmlというファイルでそのまま提供させて皆さんが見えるようになりました。
     
     　　　そのindex.htmlファイルで、HTMLがあってCSSがあって、logoのイメージもあって文章のリストを生成するためのJavaScriptもあります。

<br><br>

  つまり、静的コンテンツの配達員です！
    
![ApacheからAWSへ]( /assets/images/0005-2.png )

<br><br>

⑵　動的コンテンツの実行

　　Apache自身はプログラムの実行をしませんが、PHPへ渡します。

  <br><br>

  つまり、接客員です！
　　
![ApacheからPHPへ]( /assets/images/0005-3.png )

<br><br>

⑶　逆プロキシReverse Proxy/Load Balancer

　　　⑵のように、Apacheは、ユーザーからのリクエストを別のサーバーやアプリケーションへ転送しています。
   
   　　　　これによって、下記の役割を果たします。
       
       　　　　❶ バックエンドのアプリを隠す
           
              ❷ 複数のサーバーへ負荷分散
              
              ❸　SSLの終端になる（HTTPSを解析）

<br><br>              

  　つまり、交通指導員です！

![Apacheからserverへ]( /assets/images/0005-4.png )

<br><br>

⑷　セキュリティー・アクセス制御

　　IPアドレスやユーザー名によっての制限。

    WAFの提供。（PS：FW　→　IPアドレスとポート号を基準に通信を制御する。　WAF　→　FWの上で、リクエストの中身を見て攻撃を防ぎます。）  
    
<br><br> 

つまり、入口のチェックマンです！

![ApacheのWAF]( /assets/images/0005-5.png )

<br><br> 

⑸　URLの書き換え、リダイレクト

つまり、案内員です！

![rewrite redirect]( /assets/images/0005-6.png )

<br><br>

⑹　ログ・モニタリング（Logging & Monitoring）

   ❶　すべてのアクセスをaccess.logに記録
   ❷　すべてのエラーをerror.logに出力
   ❸　状態確認（稼働している接続数や負荷を確認）

   つまり、記録員です！

   ![log monitoring]( /assets/images/0005-7.png )
   
<br><br> 

⑺　Virtual Host

１台のサーバーで複数のサーバーを運用できます。

つまり、不動産の管理者です！

![ virtual host]( /assets/images/0005-8.png )

<br><br>

---

さぁ、これまで、なんか上記のApacheの機能はAWSでそれに対して似ているサービスがあるのを感じていますか？

そうですね。Apache機能の実現は色んなモジュールに頼ります。一方で、AWSの色んなサービスを組み合わせて同じ機能を実現できます。

下記の対応表を参照してください。

| Apacheの機能 / モジュール                                                | AWSでの対応サービス                                          | 説明                                                                |
| ---------------------------------------------------------------- | ---------------------------------------------------- | ----------------------------------------------------------------- |
| **静的コンテンツ配信（HTML・画像など）**<br>mod_mime / mod_dir                   | **S3 + CloudFront**                                  | S3に静的ファイルを置き、CloudFrontが世界中にキャッシュ・配信する。Apacheの静的ファイル配信機能と同じ役割。    |
| **HTTPS / SSL通信（暗号化）**<br>mod_ssl                                | **CloudFront / ALB / API Gateway / ACM**             | Apacheで証明書を設定していた部分を、AWSではACM（証明書管理）＋ALBやCloudFrontでSSL終端として処理する。 |
| **リバースプロキシ（Reverse Proxy）**<br>mod_proxy / mod_proxy_http        | **ALB（Application Load Balancer） / API Gateway**     | リクエストをバックエンドへ中継する。ALBは完全マネージドなリバースプロキシ。                           |
| **ロードバランサ（負荷分散）**<br>mod_proxy_balancer                          | **ALB / NLB / ELB**                                  | Apacheの手動設定不要で、AWSはトラフィックを自動で分散させる。                               |
| **動的コンテンツ実行（PHP, Pythonなど）**<br>mod_php / mod_wsgi / mod_cgi     | **ECS / Fargate / Lambda / App Runner**              | アプリケーションコードを直接実行。ApacheではPHPモジュールをロードしていたが、今はコンテナやサーバレスで実行。       |
| **URL書き換え・ルーティング**<br>mod_rewrite / mod_alias                    | **ALBのルーティングルール / API Gatewayルート設定 / CloudFrontルール** | どのURLをどの処理に送るかの制御。AWSではサービスレベルでGUI設定可能。                           |
| **アクセス制御・認証**<br>mod_auth_basic / mod_auth_digest / mod_security | **AWS WAF / Cognito / IAM / Shield**                 | 不正アクセス防御（WAF）、ユーザー認証（Cognito）、権限管理（IAM）など、セキュリティ領域に分割されている。       |
| **キャッシュ・圧縮**<br>mod_cache / mod_deflate                          | **CloudFront / ElastiCache（Redis）**                  | CloudFrontはHTTPレスポンスキャッシュを行い、ElastiCacheは動的データをキャッシュ。             |
| **ログ・監視**<br>mod_log_config / mod_status                         | **CloudWatch Logs / CloudWatch Metrics / X-Ray**     | Apacheのアクセスログ・エラーログをCloudWatchで集中管理・可視化。アラーム設定も可能。                |
| **仮想ホスト（VirtualHost）**<br>mod_vhost_alias                        | **Route53 + ALBターゲットグループ + ECSサービス**                 | ドメインごとに異なるアプリケーションを割り当てる。AWSではRoute53とALBで実現。                     |
| **設定ファイル（httpd.conf / .htaccess）**                               | **IaC（CloudFormation / CDK / Terraform）**            | 手動設定ではなく「インフラをコードで定義」する時代へ。自動再現性・バージョン管理が可能。                      |
| **セッション・Cookie制御**                                               | **ElastiCache（Redis） / DynamoDB Session Store**      | ApacheでCookieを扱っていた部分を、AWSでは専用のセッションストアで管理。                       |
| **圧縮・帯域最適化**<br>mod_brotli / mod_deflate                         | **CloudFront（圧縮機能内蔵）**                               | CloudFrontが自動的にGzip/Brotli圧縮を行う。                                  |
| **静的エラーページ処理**                                                   | **CloudFrontカスタムエラーページ / S3静的ホスティング**                | Apacheの`ErrorDocument`設定を、CloudFrontやS3の設定で実現可能。                  |
